---
layout: post
title: "[DL] 06. 인공신경망 CNN"
subtitle: "인공신경망 CNN의 개념과 특징, "
date: 2021-04-18 10:45:13
background: '/img/posts/DL_01_텍스트마이닝사진.png'
categories: ['Deep Learning']
---

<p id="eaac67cc-d9a9-41b2-9e5c-54e2e77b3593" class="">고양이와 강아지는 일반적으로 두 귀와 두 눈, 한 개의 코를 가졌다. 하지만 인간은 두 눈으로, 무엇이 고양이고 강아지인지 알아챌 수 있다.  즉, 문서로 명확히 기술하기 애매한 그들의 특징들이 존재한다. 이러한 <strong>인식 과정을 컴퓨터에 적용한 신경망 방법론이 CNN</strong>이다. 우리는 CNN을 이용해서, 컴퓨터또한 고양이와 강아지를 구분할 수 있도록 모델링할 수 있게 됐다. 이러한 유용성 덕분에, 컴퓨터비전 기술에서 CNN은 참 많이 사용되는 분야다. </p><p id="79717d4d-7e86-4cce-80f3-68b2dc2d4a71" class="">
</p><p id="8184ef8c-62a3-4654-81bf-c6167325a72c" class="">CNN은 고양이의 시각피질의 수용 영역에서 영감을 받았다. 실제 뇌에서 시각 피질의 뉴런은 일반적 시각 특징들을 수용하도록 영역별로 전문화가 이루어지는 과정을 거친다. </p><p id="67ecb81a-5cd2-4315-895d-949f1049e172" class="">
</p><h2 id="aa6f2026-605b-459d-aecc-1559916c2d5d" class="">CNN 용어정리</h2><p id="8bfc11ae-f173-415b-b7da-1bccfb3786f3" class="">다른 모델과 마찬가지로, CNN에서 주요 사용되는 용어들이 있다. 그것은 아래와 같으며, 각 순차적으로 용어의 정의를 살펴 볼 것이다.</p><p id="fd645c9b-df44-4ab3-bf13-77a924af30a5" class="">
</p><ul id="7627d7d3-c9fc-4e45-bf52-1175b190eaa7" class="bulleted-list"><li><strong>Convolution (합성곱)</strong></li></ul><ul id="934a2000-f5ba-48eb-8a27-b831e23ad699" class="bulleted-list"><li><strong>Filter (필터)</strong></li></ul><ul id="320dc836-b943-47ad-8dcd-b98d215eb0d4" class="bulleted-list"><li><strong>Padding (패딩)</strong></li></ul><ul id="eff67fad-1a3b-4f1e-b8d6-579d3e412a39" class="bulleted-list"><li><strong>Strid (스트라이드)</strong></li></ul><ul id="0e2ba248-f09f-4568-bd82-041ea73331ac" class="bulleted-list"><li><strong>Pooling (풀링)</strong></li></ul><ul id="33db733f-facb-4114-bb09-7c0ef92265a0" class="bulleted-list"><li><strong>Channel (채널)</strong></li></ul><p id="09ca82a3-fae3-43e2-9218-21686f8eb990" class="">
</p><hr id="4fd29757-2fca-4730-a3a1-2f31e146c305"/><p id="5d6137c0-680c-4be9-b41c-e7608b8ea8fb" class="">
</p><p id="cba7365b-c095-4acd-ab08-7c3c053d28e3" class="">
</p><h3 id="1626ffdb-ecab-4f46-aea6-e31cceb6965a" class="">Convolution</h3><figure id="c6734a89-f0d0-421d-a29e-0a0037bcacd3" class="image"><a href="21-04-19%20CNN%20c6734a89f0d0421da29e0a0037bcacd3/Untitled.png"><img style="width:2354px" src="21-04-19%20CNN%20c6734a89f0d0421da29e0a0037bcacd3/Untitled.png"/></a></figure><p id="179eefc3-720a-4c47-893d-3df5d0a37ae7" class="">
</p><p id="5dd30680-33ff-42cc-abdb-c192a151c111" class="">합성곱이란, <strong>슬라이딩 윈도우</strong> 방식을 이용하여 필터(가중치)를 곱해 연산을 수행한 결과다. 사전적 정의는 &#x27;두 함수 f, g 가운데 하나의 함수를 반전 &amp; 전이시킨 다음 다른 하나의 함수와 곱한 결과를 적분한 것&#x27;이다.</p><p id="95a9c862-cd81-4354-a542-c76d0a6c7445" class="">위 그림 예시를 보자. 위 그림에서는 [-1,2,-1] 필터(=엣지 필터)를 순차적으로 곱해주고, 한 값에 대해 곱한 값을 더해 합성곱 연산을 했다. 그림으로 보면 이해가 더욱 쉬울 것이다.</p><p id="093ac168-dadc-4210-8f7e-7ae1305b4868" class="">
</p><h3 id="4c1f1a87-0ed4-457b-9293-1d237bc6f91f" class="">Filter</h3><p id="f426ca6f-4c81-46a0-a27a-0eb86b0d27f2" class="">(위 개념에서 연결됨) 이때, [-1, 2, -1] 과 같은 가중치의 역할을 하는 것이 필터다. 이는 Weight(가중치)의 집합이라고 보면 된다. 가중치는 종류별로 다르며, 가중치 값의 조절에 따라 Output의 개수에 영향을 준다. (필터의 크기가 클 수록 Output 감소</p><h3 id="b15f12a3-7e7d-4b17-b34e-97bfc0d76410" class="">Padding</h3><p id="4d25f30c-6471-41b6-8843-29fb720f931e" class="">(위 개념에서 연결됨) 위처럼 필터를 사용했을 때, Output Size에 영향을 미치므로, 원본데이터 사이즈의 변화를 줄 수 없도록 원본데이터의 크기를 임의로 늘리는 것을 Padding이라고 한다. 대표적으로 Zero Padding이 있는데, 원본데이터의 좌우사방에 0 행렬을 더해주는 방식이다. 이것을 진행하면, Convolving 후에도 결과값 크기가 같다. (단, Stride = 1일 때)</p><p id="d4099edb-f122-4ffe-847f-46d358adb3a7" class="">
</p><h3 id="9713cd9d-90b0-4110-b0f8-22b4b30be512" class="">Stride </h3><p id="35fdb439-1dd3-43d0-b329-b52798fa6d39" class="">(위 개념에서 연결됨) 그렇다면, Stride란 무엇일까. Stride란, &#x27;필터를 얼만큼씩 움직이며 이미지를 연산할지 결정하는 수&#x27;이다. 만일 Stride = 1이면, 필터가 이동할 때 한 칸씩 이동한다는 것을 뜻한다. 앞서 Zero Padding이 효과가 있으려면 Stride가 1이어야 한다고 했는데, 그 이유를 조금 알 것 같지 않은가? Stride가 1보다 크면, Padding으로 원본데이터 수를 고정시켜주고자 하는 데에 한계가 있다. 데이터 수에는, Stride 크기가 큰 것이 Padding을 한 것보다 더욱 큰 영향을 주기 때문이다.</p><p id="e2a42372-afc1-4204-9668-1f3846a59c3f" class="">
</p><h3 id="154517fa-bb59-4302-9ffc-727051228ffe" class="">Pooling</h3><p id="dafe97f0-22dc-4da6-9093-0312231adf37" class="">피처맵의 차원을 축소하는 것을 말한다. 보통 합성곱을 적용한 이후 레이어를 풀링하여 점점 더 착은 피쳐맵을 얻곤 한다. 이렇게 줄인 features를 이용해 신경망에 넣어 모델링을 수행한다. (합성곱과 풀링을 반복하여 작은 피쳐맵을 생성 후, Fully Connected 된 다음 모델링하는 경우도 있다)</p><p id="c667a370-f473-4c82-a612-3eb6493464ac" class="">
</p><h3 id="d01fdb36-9b0d-4c01-8685-0e7b9cb4403d" class="">Channel</h3><p id="49839b8f-046e-45a1-92a5-52ee7c6d3953" class="">합성곱 레이어에 유입되는 입력 데이터에는 한 개 이상의 필터가 적용되는데, 이때의 1개 필터는 피쳐맵의 채널이 된다. 즉, 합성곱 레이어에 n개의 필터가 적용됐다고 한다면, 채널의 개수도 똑같이 n개라고 말한다.</p><p id="397fdcc9-7855-458d-985d-af94a07b8c60" class="">
</p><h3 id="d6640af5-7005-41fe-8501-b3a7deea9754" class="">Transfer Learning</h3><p id="abad37bb-ab50-4e36-9e2a-e376490726d5" class="">기본 소양을 가진 라이브러리를 가져와, 재사용 가능하도록 하는 라이브러리다. 대표적 예시로 고등학생과 대학수업이 있겠다. 대학에서는 고등학교와 전혀 다른 학문을 배우기도 한다. 그럼에도 불구하고, 대학마다 선수 지식(고등학교 때 어느정도는 학습해와야 한다고 생각하는 기준 혹은 지식)이 존재한다. 물론, 고등학교 때 배운 선수 지식과 대학 수업과는 목적과 방향성이 전혀 다르지만, 관련된 학습이 이미 진행 되었던 사람이므로 습득력이 훨 좋을 것이라는 것을 가정으로 둔다. 이 Transfer Learning이 바로 그러한 가정을 기반으로 둔다. 따라서, 이 라이브러리를 사용하면 <strong>교육 데이터를 더 적게 사용하고, 교육 속도가 빠르며, 더욱 잘 일반화하는 모델을 생성</strong>할 수 있다고 한다.</p><p id="6024530c-7c4d-4988-8554-2f37dac83250" class="">이러한 논리에 기반하여, NLP에서도 GPT or BERT 등이 활용되고 있다.</p><p id="fbe96fcb-a0c4-45ce-8795-fc2d198f9946" class="">
</p><p id="6a107718-a68d-4508-924a-be8f5634a9c1" class="">
</p><hr id="ada8eec4-41d0-4c77-b116-c40b7c119d27"/><p id="2f452c4b-5a53-4f88-90a6-7887d8770d7b" class="">
</p><p id="11e4638b-ea4c-41c4-9f39-b77ffc0c12ec" class="">이처럼 CNN이 핫한 이유는, CNN이 <strong>이미지 분류의 큰 한 획을 그었던 방법론</strong>이기 때문이다. 이전 기술에 비해 이미지 전처리(자르기.센터링.정규화 등)상대적으로 필요치 않다는게 무엇보다도 큰 장점이다. 또한 Weight Sharing을 하기 때문에 파라미터 개수가 줄어든다는 장점이 존재한다. </p><p id="4e3c6db4-2116-42f4-b583-bb4c625005d7" class="">공부를 하면서, 확실히 내가 친숙한(카메라 어플 필터 자주 사용하니 ㅎㅎ) 기술이라 이해가 더욱 잘 되는 것 같다! 다음 포스팅에서는 해당 개념을 어떻게 코드화할 것인지 살펴 볼 것이다!</p><p id="6e8ee893-a84a-46f6-90c6-dffe484dd047" class="">
</p><p id="c051be0a-0c4e-44dc-8b37-8f54155d954a" class="">
</p><p id="c1563d3f-30ab-4ec1-b3d3-c853af61f7fb" class="block-color-gray">지금까지 긴 글 읽어주시어 대단히 감사합니다.</p><p id="04aa1738-9878-4d2b-b215-82e9d45b3e55" class="">📧 e-mail : eng.sohee@gmail.com</p><p id="0e09432b-8444-4705-afac-483b89513856" class="">
</p><p id="0cc14e11-0927-481b-8adb-f44196ec345e" class="">
</p>
