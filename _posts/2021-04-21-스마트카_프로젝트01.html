---
layout: post
title: "[DE][PJ01] 01. 스마트카(Smart Car) 파일럿 프로젝트"
subtitle: "요구사항 및 수집.적재.처리.탐색.분석.응용 레이어 개요"
date: 2021-04-21 10:45:13
background: '/img/posts/DL_02_자동차사진.jpg'
categories: ['Data Engineering']
---


<header><h1 class="page-title">스마트카 프로젝트(완료)</h1><table class="properties"><tbody></tbody></table></header><div class="page-body"><p id="ff13478d-2bde-44da-bbe8-c50fa1b3e41b" class="">오늘부터는 대망의, <strong>데이터 엔지니어링 파일럿 프로젝트</strong>를 진행 할 것이다! </p><p id="66f155c9-5a32-41a2-8812-c4b1c3384bcb" class="">인프런의 강의를 참고하여, 데이터 수집부터 적재 &amp; 처리 및 탐색 &amp; 분석 및 응용작업까지 진행해 볼 것이다. 지금까지는 데이터의 수집과 적재에서는 Ad-hoc 방식으로 실습을 해왔다면, 이제는 대량의 데이터를 Batch처리 &amp; Stream처리하여 취급할 것이다.</p><p id="f19f885c-6866-4541-959c-928b79e79bb6" class="">빅데이터를 지탱하는 기술 책을 읽으며, 실습을 해보고 싶다고 생각해왔는데, 참 다행스럽게도 최근 인프런에서 관련 강의가 개설되어 얼마나 기쁜지 모른다. 그럼 프로젝트에 대해서 설명해보도록 하겠다.</p><p id="c16c6f2e-a89c-4849-9595-0ebcdd283ac4" class="">
</p><h2 id="d29c856f-c3cf-466f-ae83-e06e93922bd0" class="">주제 및 도메인 이해</h2><p id="a8dc09d4-98f4-4751-9d58-b3b30efa8483" class="">주제는 스마트카 프로젝트이다. 스마트카에는 정말 많은 데이터가 있다. 자동차가 어떻게 움직이는지 &amp; 운전자가 어떻게 대응하는지 등의 모든 데이터가 수집이 될 수 있다. 이처럼 스마트카에는 수백개의 iot센서가 존재하는데, 해당 데이터들을 수집,적재,탐색,분석을 진행하여 운전자에게 다양한 제공 서비스를 제공하는 것을 목적으로 프로젝트를 진행해 볼 것이다.</p><p id="c106225d-91fd-437c-9866-210b1101c356" class="">
</p><h2 id="695b5127-2398-4903-936a-99b77ba30b9d" class="">핵심 요구사항</h2><h3 id="e76c3f66-4b83-4519-8b0c-2c99a3c63915" class="">1. 차량 로그 배치 처리</h3><p id="34c21212-a55a-4c37-88eb-bd474c98f184" class="">차량의 다양한 장치로부터 발생하는 <strong>로그파일을 수집</strong>해 기능별 상태를 점검할 것이다.</p><p id="4027a9e1-a668-4c7f-b77e-ffe2478a9c51" class="">우리는 총100대의 시범 스마트카 운행 차량에서 나온 대용량 로그 파일(3초 주기로 데이터가 생성되며 24시간마다 수집함, 1대 당 1MB, 반정형 데이터)을 수집할 것이다.</p><p id="0ff17601-889c-4d81-895b-356fac9116c1" class="">
</p><h3 id="64f63d71-5068-42a9-853a-cee041b953f2" class="">2. 운전자 로그 실시간 처리</h3><p id="fe51fd87-c13b-4ded-893a-3ec7cca0fedf" class="">운전자의 <strong>운행 정보가 담긴 로그를 실시간 수집해서 분석</strong>해 볼 것이다.</p><p id="5c9bc5f3-eecc-4d1c-8915-9cf3cbd18b64" class="">이것 또한 100대의 시범 운행 차량에서 나오는 실시간 로그 파일(주행 관련 이벤트가 발생하자마자 발생된 데이터를 1초마다 수집하며, 1대당 4KB, 반정형, 분석 및 처리를 실시간으로 진행)을 수집 및 분석한다.</p><p id="a587857b-54f7-48a8-b97c-bb7048fe5a13" class="">
</p><p id="cf6273aa-9531-4fc6-85e1-4bbddb1d6e27" class="">
</p><p id="2c9240a5-b705-486d-82bd-a0bb5792614f" class="">정리하자면, <strong>스마트카 로그 시뮬레이터에서 차량 상태 정보</strong>는<strong> 3초 간격으로 일당 100MB</strong>(100대이므로)로<strong> 월단위 수집</strong>한다. 그리고<strong> 운전자 운행 정보</strong>는 <strong>1초 간격</strong>으로 발생한 데이터를 <strong>초당 400KB</strong>로 생성(100대이므로)되어 <strong>1초당 수집(=실시간 수집)</strong>된다. </p><p id="22015be6-3518-48b7-b7c3-78d854cff0a5" class="">이런 데이터가 수집 적재 처리탐색 분석응용(데이터마이닝) 단계를 거칠 수 있도록 아키텍처를 설계할 예정이다.</p><p id="c2884adc-5cc9-4177-80b3-7ad5637216ef" class="">물론 실제 프로젝트는 더 많은 데이터가 필요로 하겠지만, 파일럿 프로젝트는 대규모 빅데이터 환경인데, 투자비가 생성되기에 부담이 있으므로 개인용 PC로 가능한 정도로 파일럿 프로젝트를 진행하며 빅데이터 관련 핵심 기술을 활용할 수 있는 아키텍처를 설계할 것이다. 따라서 해당 2개의 요구사항을 만족하는 100개의 스마트카 데이터로 빅데이터 파일럿 프로젝트를 수행해보도록 하겠다.</p><p id="4e7cd7cf-4124-45bd-ae79-2cab62ca14f8" class="">
</p><p id="924d0e3b-80fc-46b8-9bf5-386607688a9c" class="">
</p><h2 id="c9e2707a-b520-4192-a44d-ada8d48ce310" class="">데이터셋 종류</h2><p id="2b16b8bc-34e5-492d-87d1-5016e276f907" class="">파일럿 프로젝트 데이터셋은 다음과같다.</p><ol id="492c978a-c0f6-4b4c-a05c-283698dd1e9e" class="numbered-list" start="1"><li><strong>스마트카 상태 정보 데이터셋</strong> - 일단위 Batch 데이터</li></ol><ol id="44b2dd21-1e47-4063-a544-4ded620a38ad" class="numbered-list" start="2"><li><strong>스마트카 운전자 운행 데이터셋</strong> - 초단위(실시간) Real-Time 데이터</li></ol><ol id="a88725f1-efd0-4265-9c4a-f697fbb54717" class="numbered-list" start="3"><li><strong>스마트카 마스터 데이터셋</strong> - 운전자의 프로파일 정보. 요구사항 1, 2 수행 시 관련 분석 데이터셋 만들 때 활용</li></ol><ol id="a1c27535-e7e0-41d2-b1d5-a8d866d02a06" class="numbered-list" start="4"><li><strong>스마트카 물품 구매 이력 데이터</strong> - 스마트카 운전자가 차량 내 스마트 스크린 통해 쇼핑몰에서 구입한 차량 물품 구매목록 데이터셋. 요구사항 1, 2 수행 시 관련 분석 데이터셋 만들 때 활용</li></ol><p id="753b7db9-4ace-412c-a8e4-83501da40031" class="">
</p><p id="153347c3-34c1-410a-889c-dae6a9d6c937" class="">
</p><h2 id="a4d11585-531d-458d-9847-cb4ba489ac0a" class="">레이어 개요</h2><p id="4db5ae64-7e6a-4f6b-bfa8-3728ed03d938" class="">이제 각 수집, 적재, 처리.탐색, 분석.응용 레이어에 대한 기본적인 사용 툴을 알아보자. <strong>해당 툴의 개념은 각 레이어 실습을 할 때마다 개념을 정의해 둘 것이니 다음 포스팅을 반드시 참고하자!!!</strong></p><p id="6a03a53b-7cfa-44f8-a2d0-b691ccf37713" class="">
</p><h3 id="116f6d4b-a6dc-462b-8f69-812c47b2e104" class="">수집 레이어 개요</h3><p id="a1fccba9-68fc-48a1-a82c-542fc4b97673" class=""><strong>플럼 카프카 스톰.에스퍼</strong>로 구성된다. 이때 데이터의 성격에 따라 수집되는 방식에 차이가 있다.</p><ul id="8a608316-d791-41ed-a20f-da8ac9f56fb2" class="bulleted-list"><li>100MB 이상의 대규모<strong> Batch 데이터</strong>는 <strong>플럼을 거쳐, 적재영역(하둡)</strong>으로 바로 이동</li></ul><ul id="860ea3b6-1ad3-4301-b482-87eb647140cf" class="bulleted-list"><li><strong>이벤트(실시간) 데이터</strong>는, <strong>플럼</strong>을 커쳐 <strong>카프카 → 스톰.에스퍼 → HBase or 레디스</strong>에 적재</li></ul><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="1d576840-c244-4fa3-9eb7-d40afeebc00c"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">🤷‍♂️ <span style="border-bottom:0.05em solid">이때 데이터 적재 시 툴의 차이가 나는 이유가 무엇일까?</span> 해당 답변은 수집 레이어 포스팅 할 때까지 구글링하여, 수집레이어 설명 시 적어두자!</div></figure><p id="f68615f9-45af-4953-8ffb-6a75b2be7fe8" class="">실시간 데이터는 배치 데이터와는 달리, 버퍼링과 트랜잭션이 있을 수 있는데, 그것을 방지하기 위해 카프카를 활용한다.</p><p id="40ec8b51-1c0c-4dd2-8218-3b62124d6f17" class="">
</p><p id="3e7281ac-f65d-4223-8ee4-f1de38587057" class=""><mark class="highlight-gray">🔥 </mark><strong><mark class="highlight-gray">트랜잭션 관리란? </mark></strong><mark class="highlight-gray">어플리케이션과 유저로부터의 요구를 관리하는 것. 예를 들면 은행 거래와 같다. 은행 송금 시 서버 장애로 A통장에서 B통장으로 출금은 됐는데 B통장에 입금내역이 없는 경우는 발생하면 안 된다. 따라서 이럴 때는 A통장에서 B통장으로 잔고가 이동한 것을 모두 확인 한 뒤에야 Commit (그렇지 않으면 Rollback)을 해줘야 한다. 이러한 요구사항에서의 충돌이 없도록 관리하는 것이 트랜잭션 관리다.</mark></p><p id="17a0626b-6f91-4fcd-bc87-c17bf4747d3b" class="">
</p><p id="d2cf4b54-320b-4c2c-b206-dabbb2e55bdc" class="">
</p><h3 id="031b06ac-8eb2-4eca-9fc7-e3c534c7ebe1" class="">적재 레이어 개요</h3><p id="2f1edf0a-f0c4-4a0c-91c4-870ad77deeb1" class="">플럼과 스톰이 수집한 데이터를 각각 <strong>하둡</strong> &amp; <strong>HBase or 레디스</strong>로 적재된다.</p><p id="29d3608c-0330-485c-9a2c-33689593cdcd" class="">대용량 Batch 데이터(하둡), 실시간성 메시지 데이터(HBase or 레디스) 처리 방법이 다르므로, 두 가지 방법론을 공부할 것이다. 특히, 실시간 데이터 처리에서는 스톰과 에스퍼를 결합하여 이벤트 프로세싱 데이터를 처리할 것이다. (특정 이벤트가 발생하면 레디스로만 이동시키는 파이프라인도 시도해 볼 것이다.)</p><p id="482b20d3-226c-4605-a947-b2433be86b2c" class="">
</p><h3 id="71fc69ee-a54d-438a-afbe-7cc9e718c0fc" class="">처리 탐색 레이어 개요</h3><p id="4dd8bf26-87e7-47ea-8051-114561287506" class="">분리저장된 데이터들을 갖고, <strong>DW 그리고 DM</strong>을 만들 것이다. 이때의 모든 과정은 자동화가 필수인데 그 때, <strong>우지 하이브 스파크 휴</strong>가 필요하다. </p><p id="edc2152f-72c3-48b6-8bbf-3d85d9d23e32" class="">
</p><h3 id="06a04a9b-87b0-468b-888d-46538e9394af" class="">분석.응용 레이어 개요</h3><p id="e5578e7b-7d6d-476b-b24a-e10d6dfca213" class="">다양한 도구 통해 탐색적 분석을 진행할 것이다. <strong>임팔라.제플린</strong> &amp; <strong>머하웃.스파크ML</strong> &amp;<strong> R.텐서플로</strong> 를 이용한다. 하둡의 분산 클러스터에서 워크로드를 생성해 분석하는 방법과 데이터를 출력해 분석하는 R 방법이 있다.</p><p id="afa8170b-43f7-4ef7-a92b-0585ba870875" class="">
</p><p id="8a207885-9d7e-4c29-9e0d-9fd936c0b7e1" class="">✔ 앞서 언급했듯, 각 툴의 개념과 활용에 대한 것은 각 레이어 설명 포스팅에 정리해 둘 예정이다. 각 툴에 대한 설명 혹은 기능에 대해 더 자세히 알고 싶다면, 다음 포스팅을 참고하자!</p><p id="2571ecff-9181-4ebd-b253-22a70e5d4f8b" class="">
</p><hr id="13075c0d-8e81-4e0c-b2bf-2f524270e4e1"/><p id="4f7d47f9-2a41-4aa7-baad-7962426cda2d" class="">
</p><h3 id="569050bd-9fc7-433c-a6ed-16452c89e37f" class="">빅데이터 파일럿 아키텍처 이해</h3><p id="36d3d21f-ef47-42d3-b67d-18a06f7f7373" class="">이제까지 빅데이터 설계 개요에 대해 익혔으니, 아키텍처 설계 방법론에 대해 모색해 볼 필요가 있다. 이때 빅데이터 하드웨어 아키텍처는 3V 관점에서 설계해야 한다는 것을 잊지 말자. 3V 는 <strong>규모 다양성 속도</strong>를 의미한다. 자세한 설명은 아래와 같다.</p><ul id="bc8c3f9e-0d65-4caa-900f-b8552a3e0264" class="bulleted-list"><li>규모: 얼마나 많은 데이터 발생하는가</li></ul><ul id="f809a762-0bcd-45a2-9604-ac3c2e036793" class="bulleted-list"><li>다양성: 어람나 다양한 데이터 발생하는가</li></ul><ul id="4870fdab-1207-46bc-95c7-7ca077c40a6b" class="bulleted-list"><li>속도: 얼마나 자주 데이터 발생하는가</li></ul><p id="21c8ed25-13dc-4a81-8cf7-fa8e47098232" class="">
</p><p id="c538a4fd-5296-4cb9-8747-897e0855ee42" class="">우리는 이와 같은 3V를 고려하며, 빅데이터 엔지니어링&amp;분석 환경을 구축할 것이다. </p><p id="7fdc7482-d1f1-4da1-b548-17f6fc2aa2ea" class="">이렇게 파일럿 프로젝트에 대한 개요를 정리해보았는데, 벌써부터 프로젝트를 해보고 싶다는 생각이 든다. 이처럼 앎의 깊이를 넓혀가는 것은 참 재밌다. 그리고 그것을 활용해 성과를 낸다는 것은 그 무엇보다도 매력있다고 생각한다. 또 며칠 잠 못자며 프로젝트하게 생겼다. 두근두근. 화이팅!!</p></div>
